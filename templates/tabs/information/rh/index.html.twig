{% extends 'base.html.twig' %}
{% block title %}Information{% endblock %}
{% block navbar %}
{% include "_headerBrut2.html.twig" %}
{% endblock %}
{% block body %}
<div class="aprole-global-container">
  <h1> Information RH </h1>

  <a class="m-3 btn" href="{{ path('information_section_new_rh') }}">Nouvelle section</a>

  <div class="row mt-3">
    <div class="col-4 mx-3">
      <div class="list-group" id="list-tab" role="tablist">

        {% set loop_rh = 0 %}
    {% for section in all_section %}
    
  {% if section.state == 1 and section.archive == 0 %}
    {% set loop_rh = loop_rh + 1 %}

    <a class="list-group-item list-group-item-action {{ loop_rh == 1 ? 'active' : '' }} " id="list-home-list" data-bs-toggle="list" href="#list-{{section.id}}" role="tab" aria-controls="list-home"> {{section.name}}</a>
  {% endif %}
    {% endfor %}
      </div>
    </div>
    <div class="col-7 tablist-custom-output">
      <div class="tab-content" id="nav-tabContent">
    {% set loop_rh = 0 %}
    {% for section in all_section %}

      {% if section.state == 1 and section.archive == 0 %}

        {% set loop_rh = loop_rh + 1 %}
          <div class="tab-pane fade show {{ loop_rh == 1 ? 'active' : '' }}" id="list-{{section.id}}" role="tabpanel" aria-labelledby="list-home-list">
            <ul>
              {% for file in all_file %}
                {% if file.section.id == section.id and file.archive == 0 %}
                  <li class="d-flex"> 
                    <span class="">
                      {{file.name}}
                      <small class="text-muted">
                        {{file.createdAt|format_datetime('full', 'short', locale='fr')}}
                      </small>
                    </span>
                    {# <span class="d-flex justify-content-around"> #}
                      <a class="btn" href="{{ path('information_files_show', {'id': file.id}) }}">
                        <i class="fas fa-eye"></i>
                      </a>
                      <a class="btn" href="{{ path('information_files_edit', {'id': file.id}) }}">
                        <i class="fas fa-edit"></i>
                      </a>
                      <form  name="archive{{file.id}}" method="post" action="{{ path('information_files_archive', {'id': file.id}) }}" class="hover">
                          <input type="hidden" name="_token" value="{{ csrf_token('archiver' ~ file.id) }}">
                          <button class="btn"><i class="far fa-file-archive"></i></button>
                      </form>
                      {{ include('tabs/information/ap_information_files/_modal_delete.html.twig') }} 
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
            <div class="d-flex justify-content-around">
              <a class="btn" href="{{ path('information_files_new', {'id': section.id}) }}">Nouveau document</a>
              <a class="btn" href="{{ path('information_section_edit', {'id': section.id}) }}">modifier la section</a>
                {# {{ include('tabs/information/ap_information_section/_modal_delete.html.twig') }} #}
                    <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#exampleModal{{section.id}}">
                      Supprimer
                    </button>

                    <form class="catalog-content-customer-container-bp" name="archive{{section.id}}" method="post" action="{{ path('information_section_archive', {'id': section.id}) }}" class="hover">
                        <input type="hidden" name="_token" value="{{ csrf_token('archiver' ~ section.id) }}">
                            <button class="w-100 btn">Archiver</button>
                    </form>
            </div>
          </div>
        {% endif %}
      {% endfor %}

      </div>
    </div>
  </div> 

  {# ARCHIVE #}

  <h3 class="mt-3"> Archive </h3>

    <div class="row mt-3">
      <div class="col-4 mx-3">
        <div class="list-group" id="list-tab" role="tablist">
          {% set loop_rh = 0 %}
      {% for section in all_section %}
        
    {% if section.state == 1 %}
      {% set loop_rh = loop_rh + 1 %}

      <a class="list-group-item list-group-item-action {{ loop_rh == 1 ? 'active' : '' }} " id="list-home-list" data-bs-toggle="list" href="#list-archive-{{section.id}}" role="tab" aria-controls="list-home"> {{section.name}}</a>
    {% endif %}
      {% endfor %}
        </div>
      </div>

      <div class=" mb-3 col-7 tablist-custom-output">
        <div class="tab-content" id="nav-tabContent">
      {% set loop_rh = 0 %}
      {% for section in all_section %}
        {% if section.state == 1 %}
          {% set loop_rh = loop_rh + 1 %}
            <div class="tab-pane fade show {{ loop_rh == 1 ? 'active' : '' }}" id="list-archive-{{section.id}}" role="tabpanel" aria-labelledby="list-home-list">
              <ul>
              {% for file in all_file %}
                {% if file.section.id == section.id and file.archive == 1 %}
                  <li class="d-flex">
                    {{file.name}}
                    <small class="text-muted">
                      {{file.createdAt|format_datetime('full', 'short', locale='fr')}}
                    </small>
                    <a class="btn" href="{{ path('information_files_show', {'id': file.id}) }}">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="btn" href="{{ path('information_files_edit', {'id': file.id}) }}">
                      <i class="fas fa-edit"></i>
                    </a> 
                    <form  name="archive{{file.id}}" method="post" action="{{ path('information_files_archive', {'id': file.id}) }}" class="hover">
                        <input type="hidden" name="_token" value="{{ csrf_token('archiver' ~ file.id) }}">
                        <button class="btn"><i class="far fa-file-archive"></i></button>
                    </form>
                    {{ include('tabs/information/ap_information_files/_modal_delete.html.twig') }}
                  </li>
                {% endif %}
              {% endfor %}
              </ul>
              <div class="d-flex justify-content-around">
                <a class="btn" href="{{ path('information_section_edit', {'id': section.id}) }}">modifier la section</a>
                {# {{ include('tabs/information/ap_information_section/_modal_delete.html.twig') }} #}
                  <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#exampleModal{{section.id}}">
                    Supprimer
                  </button>
                  <form class="catalog-content-customer-container-bp" name="archive{{section.id}}" method="post" action="{{ path('information_section_archive', {'id': section.id}) }}" class="hover">
                      <input type="hidden" name="_token" value="{{ csrf_token('archiver' ~ section.id) }}">
                      <button class="w-100 btn">DÃ©sarchiver</button>
                  </form>
              </div>
            </div>
          {% endif %}
        {% endfor %}
        {% for section in all_section %}
          {% if section.state == 2 %}
            {{ include('tabs/information/ap_information_section/_modal_delete.html.twig') }}
          {% endif %}
        {% endfor %}
        </div>
      </div>
    </div> 
  </div>
  {% endblock %}